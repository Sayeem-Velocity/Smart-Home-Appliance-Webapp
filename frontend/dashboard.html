<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Load Monitor - ESP32 Dashboard</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <!-- Auth Check -->
    <script>
        if (!localStorage.getItem('authToken')) {
            window.location.href = '/login.html';
        }
    </script>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-bolt"></i>
                <span>SecureHome AI</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-page="dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="analytics">
                <i class="fas fa-chart-line"></i>
                <span>Analytics</span>
            </a>
            <a href="#" class="nav-item" data-page="database">
                <i class="fas fa-database"></i>
                <span>Database</span>
            </a>
            <a href="#" class="nav-item" data-page="ai">
                <i class="fas fa-robot"></i>
                <span>AI Chat</span>
            </a>
            <a href="#" class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span id="username">Demo User</span>
            </div>
            <button id="logoutBtn" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button id="sidebarToggle" class="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Dashboard Overview</h1>
            </div>
            <div class="header-right">
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot disconnected"></span>
                    <span class="status-text">Disconnected</span>
                </div>
                <div class="datetime" id="datetime"></div>
            </div>
        </header>

        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page active">
            <!-- AI Autonomous Control Panel -->
            <div class="ai-control-panel">
                <div class="ai-panel-header">
                    <div class="ai-brain-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="ai-panel-title">
                        <h3>AI Autonomous Control</h3>
                        <div class="ai-status-indicator">
                            <span class="status-dot" id="aiStatusDot"></span>
                            <span class="ai-status-text" id="aiStatusText">AI Control Inactive</span>
                        </div>
                    </div>
                </div>
                <div class="ai-panel-actions">
                    <button class="ai-btn enable" id="enableAIBtn" onclick="toggleAIControl(!aiControlEnabled)">
                        <i class="fas fa-power-off"></i> Enable AI Control
                    </button>
                    <button class="ai-btn trigger" id="triggerDecisionBtn" onclick="triggerAIDecision()">
                        <i class="fas fa-bolt"></i> Trigger Decision
                    </button>
                </div>
            </div>

            <!-- ESP32 Connection Status -->
            <div class="esp32-status-panel">
                <div class="esp32-info">
                    <div class="esp32-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="esp32-details">
                        <h4>ESP32 Hardware Status</h4>
                        <span class="esp32-connection" id="esp32ConnectionText">Waiting for connection...</span>
                    </div>
                </div>
                <div class="esp32-stats">
                    <div class="esp-stat">
                        <span class="esp-stat-label">MQTT</span>
                        <span class="esp-stat-value" id="mqttStatus">--</span>
                    </div>
                    <div class="esp-stat">
                        <span class="esp-stat-label">Last Update</span>
                        <span class="esp-stat-value" id="lastUpdateTime">--</span>
                    </div>
                    <div class="esp-stat">
                        <span class="esp-stat-label">Relay 1</span>
                        <span class="esp-stat-value relay-status" id="relay1HWStatus">OFF</span>
                    </div>
                    <div class="esp-stat">
                        <span class="esp-stat-label">Relay 2</span>
                        <span class="esp-stat-value relay-status" id="relay2HWStatus">OFF</span>
                    </div>
                </div>
            </div>

            <!-- Stats Cards Row -->
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-icon voltage">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">Avg Voltage</span>
                        <span class="stat-value" id="totalVoltage">0 V</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon current">
                        <i class="fas fa-water"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">Total Current</span>
                        <span class="stat-value" id="totalCurrent">0 A</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon power">
                        <i class="fas fa-fire"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">Total Power</span>
                        <span class="stat-value" id="totalPower">0 W</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon temp">
                        <i class="fas fa-thermometer-half"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">Temperature</span>
                        <span class="stat-value" id="tempValue">0 째C</span>
                    </div>
                </div>
            </div>

            <!-- Load Cards Row -->
            <div class="loads-row">
                <!-- Load 1 Card - AC Bulb/Heater -->
                <div class="load-card" id="load1Card">
                    <div class="load-header">
                        <h3><i class="fas fa-lightbulb load-icon" id="load1Icon"></i> AC Bulb/Heater</h3>
                        <div class="load-status" id="load1Status">
                            <span class="status-badge off"></span>
                        </div>
                    </div>
                    <div class="load-gauges">
                        <div class="gauge-container">
                            <canvas id="voltageGauge1" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="voltage1">0</span>
                                <span class="gauge-unit">V</span>
                            </div>
                            <span class="gauge-title">Voltage</span>
                        </div>
                        <div class="gauge-container">
                            <canvas id="currentGauge1" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="current1">0</span>
                                <span class="gauge-unit">A</span>
                            </div>
                            <span class="gauge-title">Current</span>
                        </div>
                        <div class="gauge-container">
                            <canvas id="powerGauge1" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="power1">0</span>
                                <span class="gauge-unit">W</span>
                            </div>
                            <span class="gauge-title">Power</span>
                        </div>
                    </div>
                    <div class="load-controls">
                        <div class="load-mode-indicator auto" id="load1ModeIndicator">
                            <i class="fas fa-thermometer-half"></i> Auto Mode
                        </div>
                        <button class="control-btn on" id="load1OnBtn" onclick="controlRelay(1, true)" title="Turn ON (auto-switches to Manual mode)">
                            <i class="fas fa-power-off"></i> Turn ON
                        </button>
                        <button class="control-btn off active" id="load1OffBtn" onclick="controlRelay(1, false)" title="Turn OFF (auto-switches to Manual mode)">
                            <i class="fas fa-power-off"></i> Turn OFF
                        </button>
                    </div>
                </div>

                <!-- Load 2 Card - AC Fan -->
                <div class="load-card" id="load2Card">
                    <div class="load-header">
                        <h3><i class="fas fa-fan load-icon" id="load2Icon"></i> AC Fan</h3>
                        <div class="load-status" id="load2Status">
                            <span class="status-badge off"></span>
                        </div>
                    </div>
                    <div class="load-gauges">
                        <div class="gauge-container">
                            <canvas id="voltageGauge2" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="voltage2">0</span>
                                <span class="gauge-unit">V</span>
                            </div>
                            <span class="gauge-title">Voltage</span>
                        </div>
                        <div class="gauge-container">
                            <canvas id="currentGauge2" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="current2">0</span>
                                <span class="gauge-unit">A</span>
                            </div>
                            <span class="gauge-title">Current</span>
                        </div>
                        <div class="gauge-container">
                            <canvas id="powerGauge2" width="120" height="120"></canvas>
                            <div class="gauge-label">
                                <span class="gauge-value" id="power2">0</span>
                                <span class="gauge-unit">W</span>
                            </div>
                            <span class="gauge-title">Power</span>
                        </div>
                    </div>
                    <div class="load-controls">
                        <div class="load-mode-indicator auto" id="load2ModeIndicator">
                            <i class="fas fa-thermometer-half"></i> Auto Mode
                        </div>
                        <button class="control-btn on" id="load2OnBtn" onclick="controlRelay(2, true)" title="Turn ON (auto-switches to Manual mode)">
                            <i class="fas fa-power-off"></i> Turn ON
                        </button>
                        <button class="control-btn off active" id="load2OffBtn" onclick="controlRelay(2, false)" title="Turn OFF (auto-switches to Manual mode)">
                            <i class="fas fa-power-off"></i> Turn OFF
                        </button>
                    </div>
                </div>

            </div>

            <!-- Environment Card -->
            <div class="environment-row">
                <div class="environment-card">
                    <div class="env-header">
                        <h3><i class="fas fa-cloud-sun"></i> Environment Monitoring</h3>
                        <span class="sensor-badge">DHT11 Sensor</span>
                    </div>
                    <div class="environment-gauges">
                        <div class="env-gauge-container">
                            <canvas id="tempGauge" width="150" height="150"></canvas>
                            <div class="env-gauge-label">
                                <span class="env-gauge-value" id="tempDisplay">0</span>
                                <span class="env-gauge-unit">째C</span>
                            </div>
                            <span class="env-gauge-title">Temperature</span>
                        </div>
                        <div class="env-gauge-container">
                            <canvas id="humidityGauge" width="150" height="150"></canvas>
                            <div class="env-gauge-label">
                                <span class="env-gauge-value" id="humidityDisplay">0</span>
                                <span class="env-gauge-unit">%</span>
                            </div>
                            <span class="env-gauge-title">Humidity</span>
                        </div>
                    </div>
                    <!-- Control Mode Panel -->
                    <div class="auto-control-status" id="autoControlStatus">
                        <div class="control-mode-header">
                            <i class="fas fa-cogs"></i>
                            <h4>Control Mode</h4>
                        </div>
                        <div class="control-mode-selector">
                            <button class="mode-select-btn auto active" id="autoModeBtn" onclick="setControlMode('auto')" title="Auto mode: Temperature controls loads at 30째C threshold">
                                <i class="fas fa-thermometer-half"></i>
                                <span>Auto</span>
                            </button>
                            <button class="mode-select-btn manual" id="manualModeBtn" onclick="setControlMode('manual')" title="Manual mode: Use Turn ON/OFF buttons to control loads">
                                <i class="fas fa-hand-pointer"></i>
                                <span>Manual Control</span>
                            </button>
                        </div>
                        <div class="control-modes">
                            <div class="mode-item" id="tempControlMode">
                                <div class="mode-icon temp-mode">
                                    <i class="fas fa-thermometer-half"></i>
                                </div>
                                <div class="mode-info">
                                    <span class="mode-name">Temperature Auto Control</span>
                                    <span class="mode-detail" id="tempControlDetail">Waiting for data...</span>
                                </div>
                                <span class="mode-badge" id="tempModeBadge">STANDBY</span>
                            </div>
                            <div class="mode-item" id="manualControlMode">
                                <div class="mode-icon manual-mode">
                                    <i class="fas fa-hand-pointer"></i>
                                </div>
                                <div class="mode-info">
                                    <span class="mode-name">Manual Control</span>
                                    <span class="mode-detail" id="manualControlDetail">Use ON/OFF buttons to control loads</span>
                                </div>
                                <span class="mode-badge active" id="manualModeBadge">ACTIVE</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="charts-row">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-area"></i> Power Consumption</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="powerChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-line"></i> Voltage & Current</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="vcChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Alerts Section -->
            <div class="alerts-section">
                <div class="alerts-card">
                    <div class="alerts-header">
                        <h3><i class="fas fa-bell"></i> Recent Alerts</h3>
                        <button class="clear-alerts-btn" onclick="clearAlerts()">Clear All</button>
                    </div>
                    <div class="alerts-list" id="alertsList">
                        <div class="alert-item info">
                            <i class="fas fa-info-circle"></i>
                            <span>System started. Waiting for ESP32 connection...</span>
                            <span class="alert-time">Just now</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Load Control Page -->
        <div id="loadsPage" class="page">
            <div class="page-header">
                <h2>Load Control Panel</h2>
            </div>
            <div class="load-control-grid">
                <!-- AC Bulb/Heater Control Panel -->
                <div class="control-panel" id="controlPanel1">
                    <div class="panel-header">
                        <div class="panel-title">
                            <i class="fas fa-lightbulb panel-icon" id="panel1Icon"></i>
                            <h3>AC Bulb/Heater</h3>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="load1Toggle" onchange="toggleLoad(1, this.checked)">
                            <label for="load1Toggle"></label>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="info-row">
                            <span>Status:</span>
                            <span id="load1ControlStatus" class="status-text off">OFF</span>
                        </div>
                        <div class="info-row">
                            <span>Voltage:</span>
                            <span id="load1ControlVoltage">0 V</span>
                        </div>
                        <div class="info-row">
                            <span>Current:</span>
                            <span id="load1ControlCurrent">0 A</span>
                        </div>
                        <div class="info-row">
                            <span>Power:</span>
                            <span id="load1ControlPower">0 W</span>
                        </div>
                    </div>
                </div>

                <!-- AC Fan Control Panel -->
                <div class="control-panel" id="controlPanel2">
                    <div class="panel-header">
                        <div class="panel-title">
                            <i class="fas fa-fan panel-icon" id="panel2Icon"></i>
                            <h3>AC Fan</h3>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="load2Toggle" onchange="toggleLoad(2, this.checked)">
                            <label for="load2Toggle"></label>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="info-row">
                            <span>Status:</span>
                            <span id="load2ControlStatus" class="status-text off">OFF</span>
                        </div>
                        <div class="info-row">
                            <span>Voltage:</span>
                            <span id="load2ControlVoltage">0 V</span>
                        </div>
                        <div class="info-row">
                            <span>Current:</span>
                            <span id="load2ControlCurrent">0 A</span>
                        </div>
                        <div class="info-row">
                            <span>Power:</span>
                            <span id="load2ControlPower">0 W</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analyticsPage" class="page">
            <div class="page-header">
                <h2>Analytics & Reports</h2>
            </div>
            <div class="analytics-grid">
                <div class="analytics-card full-width">
                    <h3><i class="fas fa-chart-bar"></i> Energy Consumption History</h3>
                    <div class="chart-container large">
                        <canvas id="energyHistoryChart"></canvas>
                    </div>
                </div>
                <div class="analytics-card">
                    <h3><i class="fas fa-pie-chart"></i> Load Distribution</h3>
                    <div class="chart-container">
                        <canvas id="loadDistributionChart"></canvas>
                    </div>
                </div>
                <div class="analytics-card">
                    <h3><i class="fas fa-temperature-high"></i> Temperature Trend</h3>
                    <div class="chart-container">
                        <canvas id="temperatureChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Database Page -->
        <div id="databasePage" class="page">
            <div class="page-header">
                <h2><i class="fas fa-database"></i> Database Records</h2>
                <div class="db-controls">
                    <select id="dbTableSelect" onchange="loadDatabaseTable()">
                        <option value="telemetry">All Telemetry</option>
                        <option value="load1">AC Bulb/Heater (Load 1)</option>
                        <option value="load2">AC Fan (Load 2)</option>
                        <option value="dht11">DHT11 Sensor</option>
                    </select>
                    <button class="refresh-btn" onclick="loadDatabaseTable()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="export-btn" onclick="exportData()">
                        <i class="fas fa-download"></i> Export CSV
                    </button>
                </div>
            </div>
            <div class="database-stats" id="dbStats">
                <div class="db-stat">
                    <span class="db-stat-label">Total Records</span>
                    <span class="db-stat-value" id="totalRecords">0</span>
                </div>
                <div class="db-stat">
                    <span class="db-stat-label">Load 1 Records</span>
                    <span class="db-stat-value" id="load1Records">0</span>
                </div>
                <div class="db-stat">
                    <span class="db-stat-label">Load 2 Records</span>
                    <span class="db-stat-value" id="load2Records">0</span>
                </div>
                <div class="db-stat">
                    <span class="db-stat-label">DHT11 Records</span>
                    <span class="db-stat-value" id="dht11Records">0</span>
                </div>
            </div>
            <div class="database-table-container">
                <table class="database-table" id="databaseTable">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>Voltage (V)</th>
                            <th>Current (A)</th>
                            <th>Power (W)</th>
                            <th>Relay State</th>
                        </tr>
                    </thead>
                    <tbody id="databaseTableBody">
                        <tr>
                            <td colspan="5" class="no-data">No data available. Connect ESP32 to start collecting data.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="pagination" id="pagination">
                <button onclick="changePage(-1)"><i class="fas fa-chevron-left"></i></button>
                <span id="pageInfo">Page 1 of 1</span>
                <button onclick="changePage(1)"><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>

        <!-- AI Chat Page -->
        <div id="aiPage" class="page">
            <div class="ai-page-wrapper">
                <!-- Floating AI Chat Window -->
                <div class="ai-floating-chat">
                    <!-- Glassmorphic Header with Model Switcher -->
                    <div class="ai-float-header">
                        <div class="ai-header-left">
                            <div class="ai-avatar-glow">
                                <i class="fas fa-brain"></i>
                                <span class="ai-pulse-ring"></span>
                            </div>
                            <div class="ai-header-info">
                                <h3>Smart Energy AI</h3>
                                <div class="ai-model-indicator">
                                    <span class="ai-live-dot"></span>
                                    <span id="aiModelLabel">Gemini 2.5 Flash</span>
                                </div>
                            </div>
                        </div>
                        <div class="ai-header-actions">
                            <!-- Model Switcher -->
                            <div class="ai-model-switcher">
                                <button class="model-switch-btn active" id="modelBtnGemini" onclick="switchAIModel('gemini')" title="Google Gemini 2.5 Flash">
                                    <i class="fas fa-star"></i>
                                    <span>Gemini</span>
                                </button>
                                <button class="model-switch-btn" id="modelBtnOpenai" onclick="switchAIModel('cerebras')" title="Cerebras GPT-OSS 120B">
                                    <i class="fas fa-microchip"></i>
                                    <span>OpenAI</span>
                                </button>
                            </div>
                            <button class="ai-clear-btn" onclick="clearChatHistory()" title="Clear chat">
                                <i class="fas fa-broom"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="ai-chat-messages" id="aiChatMessages">
                        <div class="ai-welcome-card">
                            <div class="welcome-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3>Welcome to Smart Energy AI</h3>
                            <p>I monitor your home in real-time and help optimize energy usage. Ask me anything about your loads, costs, or get autonomous control recommendations.</p>
                            <div class="welcome-chips">
                                <button class="welcome-chip" onclick="askQuestion('What is my current power consumption?')">
                                    <i class="fas fa-bolt"></i> Power Usage
                                </button>
                                <button class="welcome-chip" onclick="askQuestion('How can I save energy and reduce my electricity bill?')">
                                    <i class="fas fa-leaf"></i> Save Energy
                                </button>
                                <button class="welcome-chip" onclick="askQuestion('Analyze my usage patterns and predict monthly cost')">
                                    <i class="fas fa-chart-line"></i> Cost Forecast
                                </button>
                                <button class="welcome-chip" onclick="askQuestion('What is the temperature and humidity?')">
                                    <i class="fas fa-thermometer-half"></i> Environment
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Floating Input Bar -->
                    <div class="ai-float-input">
                        <div class="ai-input-wrapper">
                            <i class="fas fa-sparkles ai-input-icon"></i>
                            <input type="text" id="aiChatInput" placeholder="Ask about your energy, devices, costs..." onkeypress="handleChatKeypress(event)" autocomplete="off">
                            <button class="ai-send-btn" onclick="sendChatMessage()" title="Send message">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="ai-input-hints">
                            <span class="ai-provider-badge" id="aiProviderBadge">
                                <i class="fas fa-star"></i> Gemini 2.5 Flash
                            </span>
                            <span class="ai-memory-badge">
                                <i class="fas fa-brain"></i> Memory Active
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Side Panel - Quick Actions -->
                <div class="ai-side-panel">
                    <div class="ai-side-section">
                        <h4><i class="fas fa-wand-magic-sparkles"></i> Quick Actions</h4>
                        <div class="ai-quick-actions">
                            <button class="ai-action-btn" onclick="askQuestion('What is my current power consumption?')">
                                <div class="action-icon"><i class="fas fa-bolt"></i></div>
                                <span>Live Power</span>
                            </button>
                            <button class="ai-action-btn" onclick="askQuestion('Tell me about all device statuses')">
                                <div class="action-icon"><i class="fas fa-plug"></i></div>
                                <span>Devices</span>
                            </button>
                            <button class="ai-action-btn" onclick="askQuestion('What is the temperature and humidity?')">
                                <div class="action-icon"><i class="fas fa-temperature-half"></i></div>
                                <span>Climate</span>
                            </button>
                            <button class="ai-action-btn" onclick="askQuestion('How much is my electricity costing today?')">
                                <div class="action-icon"><i class="fas fa-dollar-sign"></i></div>
                                <span>Cost</span>
                            </button>
                        </div>
                    </div>
                    <div class="ai-side-section">
                        <h4><i class="fas fa-lightbulb"></i> Suggestions</h4>
                        <button class="suggestion-btn-v2" onclick="askQuestion('How can I save energy and reduce my electricity bill?')">
                            <i class="fas fa-leaf"></i> Energy saving tips
                        </button>
                        <button class="suggestion-btn-v2" onclick="askQuestion('Analyze my usage patterns and predict monthly cost')">
                            <i class="fas fa-chart-bar"></i> Cost prediction
                        </button>
                        <button class="suggestion-btn-v2" onclick="askQuestion('Check for any anomalies or safety concerns')">
                            <i class="fas fa-shield-halved"></i> Safety check
                        </button>
                        <button class="suggestion-btn-v2" onclick="askQuestion('Give me a daily energy summary report')">
                            <i class="fas fa-file-lines"></i> Daily report
                        </button>
                    </div>
                    <div class="ai-side-section">
                        <h4><i class="fas fa-circle-info"></i> AI Info</h4>
                        <div class="ai-info-card">
                            <div class="ai-info-row">
                                <span>Provider</span>
                                <span id="aiInfoProvider" class="ai-info-value">Gemini</span>
                            </div>
                            <div class="ai-info-row">
                                <span>Model</span>
                                <span id="aiInfoModel" class="ai-info-value">2.5 Flash</span>
                            </div>
                            <div class="ai-info-row">
                                <span>Memory</span>
                                <span class="ai-info-value active">Per-user</span>
                            </div>
                            <div class="ai-info-row">
                                <span>DB Connected</span>
                                <span class="ai-info-value active">Yes</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page">
            <div class="page-header">
                <h2>Settings</h2>
            </div>
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-bell"></i> Alert Thresholds</h3>
                    <div class="setting-item">
                        <label>High Voltage Warning (V)</label>
                        <input type="number" id="highVoltage" value="250" min="200" max="300">
                    </div>
                    <div class="setting-item">
                        <label>High Current Warning (A)</label>
                        <input type="number" id="highCurrent" value="10" min="1" max="30" step="0.5">
                    </div>
                    <div class="setting-item">
                        <label>High Temperature Warning (째C)</label>
                        <input type="number" id="highTemp" value="35" min="25" max="50">
                    </div>
                    <button class="save-btn" onclick="saveSettings()">Save Settings</button>
                </div>
                <div class="settings-card">
                    <h3><i class="fas fa-network-wired"></i> Connection Info</h3>
                    <div class="info-display">
                        <div class="info-row">
                            <span>Server:</span>
                            <span id="serverAddress">localhost:3000</span>
                        </div>
                        <div class="info-row">
                            <span>MQTT Broker:</span>
                            <span id="mqttBroker">192.168.0.182:1883</span>
                        </div>
                        <div class="info-row">
                            <span>ESP32 Status:</span>
                            <span id="esp32Status" class="status-text off">Disconnected</span>
                        </div>
                        <div class="info-row">
                            <span>Last Data:</span>
                            <span id="lastDataTime">Never</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/dashboard.js"></script>
</body>
</html>
